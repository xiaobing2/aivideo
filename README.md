# AI 视频录制助手（提词 + 评论引导）

> **本项目由阿里云 ESA 提供加速、计算和保护。**

![阿里云ESA](https://img.alicdn.com/imgextra/i1/O1CN01KpVXvL1Yz9XqJqJqJ_!!6000000003124-2-tps-1200-400.png)

## 项目简介

AI 视频录制助手是一个面向内容创作者的 **智能录制辅助工具**，通过「视频录制 + AI 评论引导 + 提词器/大纲 + 录制建议卡片」的组合，让创作者在录制过程中不冷场、不卡壳，显著提升录制效率和内容质量。

本项目部署在 **阿里云边缘安全加速 ESA Pages** 上，利用边缘节点能力提供快速、稳定、安全的前端访问体验。

---

## 核心功能

### 1. 视频录制与管理

- 左侧为 **摄像头录制区域**，使用浏览器 `MediaRecorder` API 录制音视频。
- 支持一键 **开始录制 / 停止录制**，录制完成后自动导出 `webm` 文件。
- 录制完成的视频会保存到 **IndexedDB + localStorage**：
  - 在「视频列表」弹窗中查看历史录制、播放、删除、再次导出。
  - 本地持久化，无需后端也能管理个人录制素材。

### 2. 话题驱动的 AI 评论区

- 右侧为 **AI 评论讨论区**：
  - 用户输入一个话题（如「认知」、「如何避免不开心」等）。
  - 系统通过千问（通义千问）API 自动生成 **类似论坛/评论区的多角色对话**。
- 评论并非简单重复发问，而是：
  - 有提问、经验分享、案例、对比讨论、注意事项等多种类型。
  - 支持 **自动按间隔生成新评论**，模拟真实「讨论氛围」，减少主播冷场。
- 评论自动滚动，视觉风格为 **聊天气泡 + 用户头像 + 时间戳**，阅读体验接近真实社区。

### 3. 提词器 / 大纲提示

- 独立的 **全屏提词器弹窗**：
  - 每个话题可以维护一份录制大纲（开场、要点、案例、总结等）。
  - 支持编辑、保存大纲，并自动与当前话题绑定。
- 提供多种录制辅助能力：
  - 字体大小调节。
  - 自动滚动（速度可调）与手动滚动。
  - 键盘快捷键：空格暂停/继续滚动、上下方向键调整速度、ESC 关闭。
- 在视频录制区域内，还可以以 **叠加模式** 显示简化版大纲，边看摄像头画面边看要点。

### 4. 录制建议卡片（AIGC 驱动）

- 系统监听新生成的 AI 评论，基于评论内容 **实时生成录制建议卡片**，例如：
  - 「可以举一个职场中的实际案例来说明这个观点」
  - 「尝试对比一下传统方法和你提出的方法」
  - 「可以从注意事项的角度再总结一段」
- 建议卡片自动淡入/淡出，可手动关闭，也可全部隐藏/显示。
- 让录制者始终有「下一句大概说什么、从哪个角度说」的灵感。

### 5. 话题历史与 API Key 管理

- **话题历史**：
  - 自动记录使用过的话题。
  - 可搜索、点击回填到当前话题中，快速复用之前的录制主题。
- **API Key 设置**：
  - 在设置弹窗中输入并保存千问 API Key。
  - 安全存储在浏览器 `localStorage`，前端在调用千问接口时读取。

---

## 创意性说明（对应「创意卓越」）

- 将「视频录制」和「AI 评论 / 讨论区」做了 **强结合**：  
  不只是一个纯录制工具，而是把录制场景包装成「边录制，边参与一个围绕话题的在线讨论」。
- 同时提供 **多层级辅助**：
  - 话题驱动的 AI 评论（宏观氛围）
  - 可编辑的大纲提词器（结构化内容）
  - 自动生成的录制建议卡片（微观提示）
- 整体 UI 采用 **未来科技 3D 风格 + 玻璃拟态**，在视觉上与「边缘计算 / AIGC」主题呼应。

---

## 应用价值说明（对应「应用价值」）

- 适合个人创作者、知识博主、企业培训录课等多种场景：
  - 避免冷场：AI 评论和建议卡片帮助持续输出话题点。
  - 提升表达质量：提词器和建议引导让内容更有结构和深度。
- 部署在 ESA Pages 上，**部署即用**：
  - 无需自建后端，只需提供千问 API Key。
  - 可直接作为 SaaS 工具供团队或个人使用。
- 支持本地持久化录制与多次导出，便于后期剪辑与内容复用。

---

## 技术架构（对应「技术探索」）

### 前端技术栈

- **框架**：React + TypeScript + Vite
- **样式**：Tailwind CSS + 自定义 `tech3d.css`（3D 科技风、玻璃拟态、动画）
- **状态与组件拆分**：
  - `App.tsx`：整体布局与弹窗管理
  - `VideoRecorder`：摄像头初始化、录制控制、提词器局部叠加、建议卡片区域
  - `CommentPanel`：话题输入、AI 评论展示、自动滚动
  - `Teleprompter`：全屏提词器
  - `VideoList`、`TopicHistory`、`ApiKeySettings`等

### AI 能力与本地存储

- **AI 评论生成**：
  - `src/utils/aiService.ts` 中通过千问 API 调用。
  - 设计了针对「评论区」的 Prompt，鼓励多样化评论形态（问答、案例、对比、总结）。
- **评论驱动建议生成**：
  - `src/utils/suggestionGenerator.ts`：将评论文本解析为多个建议类型（提问、案例、对比、经验等）。
  - `SuggestionCard` 组件负责样式与生命周期管理。
- **本地存储层**：
  - `videoStorage.ts`：IndexedDB 存储视频 Blob，localStorage 存储元信息。
  - `topicStorage.ts`：localStorage 维护话题历史。

### 边缘部署（ESA Pages）

- 使用 **阿里云 ESA Pages** 部署：
  - 前端静态资源构建为纯静态文件（`npm run build` → `dist/`）。
  - 通过 GitHub 仓库和 ESA Pages 打通 CI/CD，**push 即自动部署**。
- 项目可进一步扩展接入：
  - **边缘函数**：将 AI 调用下沉到边缘，统一安全控制密钥、加缓存。
  - **边缘存储**：未来可以将视频元数据与索引迁移到边缘 KV/对象存储。
  - **缓存策略**：对静态资源与非隐私接口做强缓存，提升首屏速度。

## 快速开始

### 1. 安装依赖

```bash
npm install
```

### 2. 启动开发服务器

```bash
npm run dev
```

应用将在 `http://localhost:3000` 启动

### 3. 配置API密钥

首次启动时，应用会自动弹出设置对话框，或者点击右上角的"⚙️ 设置"按钮：

1. 访问 [阿里云DashScope控制台](https://dashscope.console.aliyun.com/)
2. 注册/登录账号
3. 进入"API-KEY管理"页面
4. 创建新的API密钥
5. 将密钥粘贴到设置对话框中
6. 点击"保存"

**注意**：API密钥会保存在浏览器本地存储中，不会上传到服务器。

### 4. 构建生产版本

```bash
npm run build
```

## 使用说明

1. **配置API密钥**（首次使用）:
   - 启动应用后，如果没有配置API密钥，会自动弹出设置对话框
   - 或者点击右上角"⚙️ 设置"按钮
   - 输入千问API密钥并保存

2. **开始录制**:
   - 点击左侧"开始录制"按钮
   - 允许浏览器访问摄像头和麦克风权限
   - 录制过程中可以暂停/继续

3. **生成评论**:
   - 在右侧输入话题（例如："人工智能的未来发展"）
   - 点击"生成评论"按钮
   - AI会自动生成5条相关评论

4. **自动生成**:
   - 勾选"自动生成评论"选项
   - 仅在录制时生效
   - 可设置生成间隔（3秒/5秒/10秒/15秒）

5. **保存视频**:
   - 点击"停止录制"后，视频会自动下载
   - 文件名格式：`录制_话题名_时间戳.webm`

## 项目结构

```
aivideo/
├── src/
│   ├── components/          # React组件
│   │   ├── VideoRecorder.tsx    # 视频录制组件
│   │   ├── CommentPanel.tsx     # 评论面板组件
│   │   └── ApiKeySettings.tsx    # API密钥设置组件
│   ├── utils/               # 工具函数
│   │   ├── aiService.ts         # AI服务集成
│   │   └── apiKeyStorage.ts     # API密钥存储管理
│   ├── App.tsx              # 主应用组件
│   ├── main.tsx             # 入口文件
│   └── index.css            # 全局样式
├── index.html
├── package.json
├── vite.config.ts
└── README.md
```

## 注意事项

1. **API密钥配置**: API密钥保存在浏览器本地存储（localStorage）中，清除浏览器数据会丢失密钥
2. **浏览器兼容性**: 需要支持MediaRecorder API的现代浏览器（Chrome、Firefox、Edge等）
3. **HTTPS要求**: 某些浏览器在非HTTPS环境下可能无法访问摄像头
4. **API限制**: 注意千问API的调用频率限制，避免过度请求
5. **视频格式**: 默认使用WebM格式，如需其他格式可修改MediaRecorder配置

